let e,o;var t,n=globalThis,a={},r={},i=n.parcelRequire4ef1;null==i&&((i=function(e){if(e in a)return a[e].exports;if(e in r){var o=r[e];delete r[e];var t={id:e,exports:{}};return a[e]=t,o.call(t.exports,t,t.exports),t.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,o){r[e]=o},n.parcelRequire4ef1=i),i.register;var d=i("fgYff");let c=new WebSocket("ws://localhost:3001"),s="VIDEO";const l="480px";console.log("Load OK"),async function(){let o=await (0,d.FilesetResolver).forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.0/wasm");e=await (0,d.FaceLandmarker).createFromOptions(o,{baseOptions:{modelAssetPath:"https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task",delegate:"GPU"},outputFaceBlendshapes:!0,runningMode:s,numFaces:1})}();const u=document.querySelector(".video2"),v=document.querySelector(".canvas2"),E=v.getContext("2d");(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia)&&document.querySelector("button").addEventListener("click",function(e){let o=document.querySelector("#video-select2");o.innerHTML="<option></option>",navigator.mediaDevices.enumerateDevices().then(e=>{e.forEach((e,t)=>{"videoinput"===e.kind&&(o.addEventListener("change",g),o.innerHTML+=`<option value="${e.deviceId}">${e.label}</option>`)})}),u.addEventListener("loadeddata",_)});let F=null,m=!1,L="";async function g(e){let o=e.target.value;L=o;let t=await navigator.mediaDevices.getUserMedia({video:{deviceId:o}});if(u.srcObject=t,console.log("changeVideo2"),""===o&&m){F.stop();return}p(o)}async function p(e){let o=await navigator.mediaDevices.getUserMedia({video:{deviceId:e}});m&&w&&((F=new MediaRecorder(o)).ondataavailable=e=>{m&&e.data&&e.data.size>0&&c.send(e.data)},F.start(200))}let f=-1;const A=new d.DrawingUtils(E);async function _(){let t=u.videoHeight/u.videoWidth;u.style.width=l+"px",u.style.height=l*t+"px",v.style.width=l+"px",v.style.height=l*t+"px",v.width=u.videoWidth,v.height=u.videoHeight,"IMAGE"===s&&(s="VIDEO",await e.setOptions({runningMode:s}));let n=performance.now();if(f!==u.currentTime&&(f=u.currentTime,o=e.detectForVideo(u,n)),o.faceLandmarks)for(let e of o.faceLandmarks)A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_TESSELATION,{color:"#C0C0C070",lineWidth:1}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_RIGHT_EYE,{color:"#FF3030"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_RIGHT_EYEBROW,{color:"#FF3030"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_LEFT_EYE,{color:"#30FF30"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_LEFT_EYEBROW,{color:"#30FF30"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_FACE_OVAL,{color:"#E0E0E0"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_LIPS,{color:"#E0E0E0"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_RIGHT_IRIS,{color:"#FF3030"}),A.drawConnectors(e,d.FaceLandmarker.FACE_LANDMARKS_LEFT_IRIS,{color:"#30FF30"});window.requestAnimationFrame(_)}c.addEventListener("error",function(e){m=!1,console.log("沒有連線"),console.log(e)}),c.addEventListener("open",function(e){m=!0,console.log("連線成功")}),c.addEventListener("close",function(e){m=!1,console.log("連線中斷")}),c.addEventListener("message",function(e){console.log("收到訊息")});let w=!1,C=document.querySelector("#recordF");C.addEventListener("click",()=>{if(console.log(w),w)w=!w,C.textContent="Start Record Pose",F.stop();else{p(L),w=!w,C.textContent="Stop Record Pose";return}});
//# sourceMappingURL=index.891b793b.js.map
